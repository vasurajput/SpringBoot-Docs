<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>XML Modal Example</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <button id="openModalBtn">Open Import Request Modal</button>

  <!-- Modal -->
  <div id="xmlModal" class="modal-overlay" style="display:none;">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Import Request</h2>
        <button id="closeModalBtn" class="close-btn">✕</button>
      </div>
      <div class="modal-body">
        <!-- Client Details -->
        <button class="accordion-toggle" data-section="client">Client Details ▼</button>
        <div class="accordion-content" data-section="client">
          <label>Client ID</label><input name="clientId" value="CO1CID012563">
          <label>Name</label><input name="name">
          <label>Address</label><input name="address">
          <label>City</label><input name="city">
          <label>Province</label><input name="province">
          <label>Post Code</label><input name="postCode">
          <label>Country</label><input name="country">
          <label>Template Name</label><input name="templateName">
          <label>User Assigned Login Enabled</label><input name="userAssignedLoginIdEnabled" value="true">
        </div>

        <!-- Auto Debit -->
        <button class="accordion-toggle" data-section="auto">Auto Debit Details ▼</button>
        <div class="accordion-content" data-section="auto">
          <label>Account Number</label><input name="accountNumber">
          <label>Branch Code</label><input name="branchCode">
          <label>Account Holder Name</label><input name="accountHolderName">
          <label>Account Holder Local Name</label><input name="accountHolderLocalName">
          <label>Account Currency</label><input name="accountCurrency">
          <label>Default Account</label><input name="defaultAccount">
        </div>

        <!-- User -->
        <button class="accordion-toggle" data-section="user">User Details ▼</button>
        <div class="accordion-content" data-section="user">
          <label>User ID</label><input name="userId" value="CO1UID01235673">
          <label>Application ID</label><input name="applicationId" value="APP-ID">
          <label>Email</label><input name="email">
          <label>First Name</label><input name="firstName">
          <label>Last Name</label><input name="lastName">
          <label>User Template Name</label><input name="userTemplateName">
          <label>Login ID</label><input name="loginId">
          <label>External ID</label><input name="externalId">
          <label>SSO Disabled</label><input name="ssoDisabled" value="false">
        </div>
      </div>
      <div class="modal-footer">
        <button id="submitBtn" class="submit-btn">Submit</button>
      </div>
    </div>
  </div>

  <script src="main.js"></script>
</body>
</html>


.modal-overlay {
  position: fixed; inset: 0; display: flex; justify-content: center; align-items: center;
  background: rgba(0,0,0,0.5);
}
.modal-container { background: #fff; padding: 20px; border-radius: 10px; width: 600px; max-height: 90vh; overflow-y: auto; }
.modal-header { display: flex; justify-content: space-between; align-items: center; }
.close-btn { background: transparent; border: none; font-size: 20px; cursor: pointer; }
.accordion-toggle { width: 100%; text-align: left; padding: 10px; margin-top: 10px; cursor: pointer; }
.accordion-content { display: none; margin: 10px 0; }
.accordion-content label { display:block; margin:5px 0 2px; }
.accordion-content input { width:100%; padding:5px; margin-bottom:8px; }



function xmlEscape(v = "") {
  return String(v)
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&apos;");
}
function tagIf(name, val) {
  return val && String(val).trim() !== "" ? `<${name}>${xmlEscape(val)}</${name}>` : "";
}
function generateXml(data) {
  const clientTags = [
    tagIf("name", data.name),
    tagIf("address", data.address),
    tagIf("city", data.city),
    tagIf("province", data.province),
    tagIf("postCode", data.postCode),
    tagIf("country", data.country),
    tagIf("templateName", data.templateName),
    tagIf("userAssignedLoginIdEnabled", data.userAssignedLoginIdEnabled),
  ].filter(Boolean).join("");

  const autoDebitTags = [
    tagIf("accountNumber", data.accountNumber),
    tagIf("branchCode", data.branchCode),
    tagIf("accountHolderName", data.accountHolderName),
    tagIf("accountHolderLocalName", data.accountHolderLocalName),
    tagIf("accountCurrency", data.accountCurrency),
    tagIf("defaultAccount", data.defaultAccount),
  ].filter(Boolean).join("");

  const userTags = [
    tagIf("applicationId", data.applicationId),
    tagIf("email", data.email),
    tagIf("firstName", data.firstName),
    tagIf("lastName", data.lastName),
    tagIf("templateName", data.userTemplateName),
    tagIf("loginId", data.loginId),
    tagIf("externalId", data.externalId),
    tagIf("ssoDisabled", data.ssoDisabled),
  ].filter(Boolean).join("");

  return `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>` +
    `<ns:importRequest xmlns:ns="http://www.westernunionbusiness.com/geo/cma">` +
      `<client id="${xmlEscape(data.clientId)}">` +
        clientTags +
        (autoDebitTags ? `<autoDebitAccount>${autoDebitTags}</autoDebitAccount>` : "") +
        (userTags ? `<user id="${xmlEscape(data.userId)}">${userTags}</user>` : "") +
      `</client>` +
    `</ns:importRequest>`;
}

// Modal controls
const modal = document.getElementById("xmlModal");
document.getElementById("openModalBtn").onclick = () => modal.style.display = "flex";
document.getElementById("closeModalBtn").onclick = () => modal.style.display = "none";

// Accordion toggle
document.querySelectorAll(".accordion-toggle").forEach(btn => {
  btn.addEventListener("click", () => {
    const section = btn.dataset.section;
    const content = document.querySelector(`.accordion-content[data-section="${section}"]`);
    content.style.display = content.style.display === "block" ? "none" : "block";
  });
});

// Submit
document.getElementById("submitBtn").onclick = () => {
  const inputs = document.querySelectorAll("#xmlModal input");
  const data = {};
  inputs.forEach(i => data[i.name] = i.value);
  const xml = generateXml(data);
  console.log("XML payload →", xml);
  alert("XML Generated! Check console.");
  modal.style.display = "none";
};




